<meta name="description" content="3 styles with inline editable feature" />
<!-- page specific plugin styles -->
<link rel="stylesheet" href="../../static/css/jquery-ui.custom.min.css" />
<link rel="stylesheet" href="../../static/css/jquery.gritter.css" />
<link rel="stylesheet" href="../../static/css/select2.css" />
<link rel="stylesheet" href="../../static/css/datepicker.css" />
<link rel="stylesheet" href="../../static/css/bootstrap-editable.css" />
<!--省市县><![endif]-->
<link href="../../static/custom/fdev-float.css" rel="stylesheet" charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="../../static/custom/alp-min.css?version=3.6.6"/>
<script src="../../static/custom/fdev-min.js"></script>
<script type="text/javascript" src="../../static/custom/alpCommon.js?version=3.6.6"></script>
<div class="row">
   <div class="col-xs-12">
      <!-- PAGE CONTENT BEGINS -->
      <div class="hr dotted"></div>
      <div id="user-profile-3" class="user-profile row">
         <div class="col-sm-offset-1 col-sm-10">
            <form class="form-horizontal">
               <div class="tabbable">
                  <div class="tab-content profile-edit-tab-content">
                     <div id="edit-basic" class="tab-pane in active">
                        <div class="row">
                           <div class="col-xs-12 col-sm-8">
                              <div class="space-8"></div>
                              <div class="form-group">
                                 <label class="col-sm-4 control-label no-padding-right" for="form-field-date">出生日期</label>
                                 <div class="col-sm-8">
                                    <div class="input-medium">
                                       <div class="input-group">
                                          <input class="input-medium date-picker" id="form-field-date" type="text" data-date-format="dd-mm-yyyy" placeholder="dd-mm-yyyy" />
                                          <span class="input-group-addon">
                                          <i class="ace-icon fa fa-calendar"></i>
                                          </span>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="space-4"></div>
                              <div class="form-group">
                                 <label class="col-sm-4 control-label no-padding-right" for="form-field-weight">体重</label>
                                 <div class="col-sm-8">
                                    <input class="col-xs-12 col-sm-10" type="text" id="form-field-weight" placeholder="kg"/>
                                 </div>
                              </div>
                              <div class="space-4"></div>
                              <div class="form-group">
                                 <label class="col-sm-4 control-label no-padding-right" for="form-field-height">身高</label>
                                 <div class="col-sm-8">
                                    <input class="col-xs-12 col-sm-10" type="text" id="form-field-height" placeholder="m"/>
                                 </div>
                              </div>
                              <div class="space-4"></div>
                              <div class="form-group">
                                 <label class="col-sm-4 control-label no-padding-right" for="form-field-company">单位</label>
                                 <div class="col-sm-8">
                                    <input class="col-xs-12 col-sm-10" type="text" id="form-field-company"/>
                                 </div>
                              </div>
                              <div class="space-4"></div>
                              <script type="text/javascript">
                                 jQuery(document).ready(function() {
                                     try{
                                     ALP.Util.tracelog.initAliclick();
                                     }catch(e){}
                                     });
                                                     
                              </script>
                              <div class="form-group">
                                 <label class="col-sm-4 control-label no-padding-right" for="source-area">常驻地</label>
                                 <div class="col-sm-8">
                                    <input class="alp-area-text" autocomplete="off" id="source-area" style="font-size:14px;width:83.333%;margin:0;height:100%" />
                                    <div id="source-area-select" class="area-select"></div>
                                 </div>
                              </div>
                           </div>
                           <div class="vspace-12-sm"></div>
                           <div class="col-xs-12 col-sm-4">
                              <div class="space-4"></div>
                              <p style="font-size:large;font-style:bold">请上传照片</p>
                              <img id="avatar" class="editable img-responsive" alt="请上传照片" src="../../static/avatars/profile-pic.jpg" />
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </form>
         </div>
         <!-- /.span -->
      </div>
      <!-- /.user-profile -->
      <!-- PAGE CONTENT ENDS -->
   </div>
   <!-- /.col -->
</div>
<!-- /.row -->
<!--[if !IE]> -->
<script type="text/javascript">
   window.jQuery || document.write("<script src='../../static/js/jquery.min.js'>"+"<"+"/script>");
</script>
<!-- <![endif]-->
<!--[if IE]>
<script type="text/javascript">
   window.jQuery || document.write("<script src='../../static/js/jquery1x.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
<script type="text/javascript">
   if('ontouchstart' in document.documentElement) document.write("<script src='../../static/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
</script>
<script src="../../static/js/bootstrap.min.js"></script>
<!-- page specific plugin scripts -->
<!--[if lte IE 8]>
<script src="../../static/js/excanvas.min.js"></script>
<![endif]-->
<script src="../../static/js/jquery-ui.custom.min.js"></script>
<script src="../../static/js/jquery.ui.touch-punch.min.js"></script>
<script src="../../static/js/jquery.gritter.min.js"></script>
<script src="../../static/js/bootbox.min.js"></script>
<script src="../../static/js/jquery.easypiechart.min.js"></script>
<script src="../../static/js/date-time/bootstrap-datepicker.min.js"></script>
<script src="../../static/js/jquery.hotkeys.min.js"></script>
<script src="../../static/js/bootstrap-wysiwyg.min.js"></script>
<script src="../../static/js/select2.min.js"></script>
<script src="../../static/js/fuelux/fuelux.spinner.min.js"></script>
<script src="../../static/js/x-editable/bootstrap-editable.min.js"></script>
<script src="../../static/js/x-editable/ace-editable.min.js"></script>
<script src="../../static/js/jquery.maskedinput.min.js"></script>
<!-- ace scripts -->
<script src="../../static/js/ace-elements.min.js"></script>
<script src="../../static/js/ace.min.js"></script>
<!-- inline scripts related to this page -->
<script type="text/javascript">
   jQuery(function($) {
   
       //editables on first profile page
       $.fn.editable.defaults.mode = 'inline';
       $.fn.editableform.loading = "<div class='editableform-loading'><i class='ace-icon fa fa-spinner fa-spin fa-2x light-blue'></i></div>";
       $.fn.editableform.buttons = '<button type="submit" class="btn btn-info editable-submit"><i class="ace-icon fa fa-check"></i></button>'+
       '<button type="button" class="btn editable-cancel"><i class="ace-icon fa fa-times"></i></button>';    
   
   
   
       // *** editable avatar *** //
       try {//ie8 throws some harmless exceptions, so let's catch'em
   
       //first let's add a fake appendChild method for Image element for browsers that have a problem with this
       //because editable plugin calls appendChild, and it causes errors on IE at unpredicted points
       try {
       document.createElement('IMG').appendChild(document.createElement('B'));
       } catch(e) {
       Image.prototype.appendChild = function(el){}
       }
   
       var last_gritter
         $('#avatar').editable({
   type: 'image',
   name: 'avatar',
   value: null,
   image: {
   //specify ace file input plugin's options here
   btn_choose: 'Change Avatar',
   droppable: true,
   maxSize: 2000000,//~2MB
   
   //and a few extra ones here
   name: 'avatar',//put the field name here as well, will be used inside the custom plugin
   on_error : function(error_type) {//on_error function will be called when the selected file has a problem
   if(last_gritter) $.gritter.remove(last_gritter);
   if(error_type == 1) {//file format error
   last_gritter = $.gritter.add({
   title: '该文件不是图片格式',
   text: '请选择一个jpg|gif|png格式的图片',
   class_name: 'gritter-error gritter-center'
   });
   } else if(error_type == 2) {//file size rror
     last_gritter = $.gritter.add({
   title: '文件过大',
   text: '上传照片请勿超过2M',
   class_name: 'gritter-error gritter-center'
   });
   }
   else {//other error
   }
   },
   on_success : function() {
                  $.gritter.removeAll();
                }
   },
   url: function(params) {
          // ***UPDATE AVATAR HERE*** //
          //for a working upload example you can replace the contents of this function with 
          //examples/profile-avatar-update.js
   
          var deferred = new $.Deferred
   
            var value = $('#avatar').next().find('input[type=hidden]:eq(0)').val();
          if(!value || value.length == 0) {
            deferred.resolve();
            return deferred.promise();
          }
   
   
          //dummy upload
          setTimeout(function(){
              if("FileReader" in window) {
              //for browsers that have a thumbnail of selected image
              var thumb = $('#avatar').next().find('img').data('thumb');
              if(thumb) $('#avatar').get(0).src = thumb;
              }
   
              deferred.resolve({'status':'OK'});
   
              if(last_gritter) $.gritter.remove(last_gritter);
              last_gritter = $.gritter.add({
   title: 'Avatar Updated!',
   text: 'Uploading to server can be easily implemented. A working example is included with the template.',
   class_name: 'gritter-info gritter-center'
   });
   
              } , parseInt(Math.random() * 800 + 800))
   
   return deferred.promise();
   
   // ***END OF UPDATE AVATAR HERE*** //
   },
   
   success: function(response, newValue) {
            }
   })
   }catch(e) {}
   
   
   
   //another option is using modals
   $('#avatar2').on('click', function(){
       var modal = 
       '<div class="modal fade">\
       <div class="modal-dialog">\
       <div class="modal-content">\
       <div class="modal-header">\
       <button type="button" class="close" data-dismiss="modal">&times;</button>\
       <h4 class="blue">Change Avatar</h4>\
       </div>\
       \
       <form class="no-margin">\
       <div class="modal-body">\
       <div class="space-4"></div>\
       <div style="width:75%;margin-left:12%;"><input type="file" name="file-input" /></div>\
       </div>\
       \
       <div class="modal-footer center">\
       <button type="submit" class="btn btn-sm btn-success"><i class="ace-icon fa fa-check"></i> Submit</button>\
       <button type="button" class="btn btn-sm" data-dismiss="modal"><i class="ace-icon fa fa-times"></i> Cancel</button>\
       </div>\
       </form>\
       </div>\
       </div>\
       </div>';
   
   var modal = $(modal);
   modal.modal("show").on("hidden", function(){
       modal.remove();
       });
   
   var working = false;
   
   var form = modal.find('form:eq(0)');
   var file = form.find('input[type=file]').eq(0);
   file.ace_file_input({
   style:'well',
   btn_choose:'Click to choose new avatar',
   btn_change:null,
   no_icon:'ace-icon fa fa-picture-o',
   thumbnail:'small',
   before_remove: function() {
   //don't remove/reset files while being uploaded
   return !working;
   },
   allowExt: ['jpg', 'jpeg', 'png', 'gif'],
   allowMime: ['image/jpg', 'image/jpeg', 'image/png', 'image/gif']
   });
   
   form.on('submit', function(){
       if(!file.data('ace_input_files')) return false;
   
       file.ace_file_input('disable');
       form.find('button').attr('disabled', 'disabled');
       form.find('.modal-body').append("<div class='center'><i class='ace-icon fa fa-spinner fa-spin bigger-150 orange'></i></div>");
   
       var deferred = new $.Deferred;
       working = true;
       deferred.done(function() {
         form.find('button').removeAttr('disabled');
         form.find('input[type=file]').ace_file_input('enable');
         form.find('.modal-body > :last-child').remove();
   
         modal.modal("hide");
   
         var thumb = file.next().find('img').data('thumb');
         if(thumb) $('#avatar2').get(0).src = thumb;
   
         working = false;
         });
   
   
       setTimeout(function(){
           deferred.resolve();
           } , parseInt(Math.random() * 800 + 800));
   
       return false;
   });
   
   });
   
   
   
   //////////////////////////////
   $('#profile-feed-1').ace_scroll({
   height: '250px',
   mouseWheelLock: true,
   alwaysVisible : true
   });
   
   $('a[ data-original-title]').tooltip();
   
   $('.easy-pie-chart.percentage').each(function(){
       var barColor = $(this).data('color') || '#555';
       var trackColor = '#E2E2E2';
       var size = parseInt($(this).data('size')) || 72;
       $(this).easyPieChart({
   barColor: barColor,
   trackColor: trackColor,
   scaleColor: false,
   lineCap: 'butt',
   lineWidth: parseInt(size/10),
   animate:false,
   size: size
   }).css('color', barColor);
       });
   
   ///////////////////////////////////////////
   
   //right & left position
   //show the user info on right or left depending on its position
   $('#user-profile-2 .memberdiv').on('mouseenter touchstart', function(){
       var $this = $(this);
       var $parent = $this.closest('.tab-pane');
   
       var off1 = $parent.offset();
       var w1 = $parent.width();
   
       var off2 = $this.offset();
       var w2 = $this.width();
   
       var place = 'left';
       if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) place = 'right';
   
       $this.find('.popover').removeClass('right left').addClass(place);
       }).on('click', function(e) {
         e.preventDefault();
         });
   
   
   ///////////////////////////////////////////
   $('#user-profile-3')
   .find('input[type=file]').ace_file_input({
   style:'well',
   btn_choose:'Change avatar',
   btn_change:null,
   no_icon:'ace-icon fa fa-picture-o',
   thumbnail:'large',
   droppable:true,
   
   allowExt: ['jpg', 'jpeg', 'png', 'gif'],
   allowMime: ['image/jpg', 'image/jpeg', 'image/png', 'image/gif']
   })
   .end().find('button[type=reset]').on(ace.click_event, function(){
       $('#user-profile-3 input[type=file]').ace_file_input('reset_input');
       })
   .end().find('.date-picker').datepicker().next().on(ace.click_event, function(){
       $(this).prev().focus();
       })
   $('.input-mask-phone').mask('(999) 999-9999');
   
   ////////////////////
   //change profile
   $('[data-toggle="buttons"] .btn').on('click', function(e){
       var target = $(this).find('input[type=radio]');
       var which = parseInt(target.val());
       $('.user-profile').parent().addClass('hide');
       $('#user-profile-'+which).parent().removeClass('hide');
       });
   });
</script>
<script type="text/javascript" src="../../static/custom/estimatePrice-min.js?version=3.6.6"></script>
<script type="text/javascript">
   try {
     if (window.name) {
       var param = jQuery.parseJSON(window.name.replace(/\'/g, "\""));
       if (param && param.workpagepara && param.workpagepara.iframe == true) {
         jQuery('#alibar').remove();
         jQuery('#alp-logo-image').remove();
         jQuery('#alp-work-logo-image').css('display',''); 
       } 
     }
   } catch (e) {
   }
</script>
<!-- the following scripts are used in demo only for onpage help and you don't need them -->
<link rel="stylesheet" href="../../static/css/ace.onpage-help.css" />
